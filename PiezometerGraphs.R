# Rename columns to be R friendly. 
#Piezocat is cation data from piezometers, BDP, and DP
newname<-c("sample_name","Site","date","Depth_cm","Al_mgL","Ca_mgL","Fe_mgL","K_mgL","Mg_mgL","Mn_mgL","Na_mgL")
piezocat<-read.csv(file="PiezometerData.csv",header=TRUE)
colnames(piezocat)<-newname
#Piezoan is anion data from piezometers, BDP, and DP
icnewname<-c("sample_name","Site","date","Depth_cm","SO42_mgL","Cl_mgL")
piezoan<-read.csv(file="ICPiezometer.csv",header=TRUE)
colnames(piezoan)<-icnewname

#Transform mg/L to mmol/L

piezocat$Al_mmolL<-(piezocat$Al_mgL/26.982)
piezocat$Ca_mmolL<-(piezocat$Ca_mgL/40.08)
piezocat$Fe_mmolL<-(piezocat$Fe_mgL/55.845)
piezocat$K_mmolL<-(piezocat$K_mgL/39.099)
piezocat$Mg_mmolL<-(piezocat$Mg_mgL/24.305)
piezocat$Mn_mmolL<-(piezocat$Mn_mgL/54.938)
piezocat$Na_mmolL<-(piezocat$Na_mgL/22.99)

piezoan$SO42_mmolL<-(piezoan$SO42_mgL/96.06)
piezoan$Cl_mmolL<-(piezoan$Cl_mgL/35.453)


#box and whisker plot of piezometer data and SO42-
plot(piezoan$sample_name,piezoan$SO42_mmolL)

#box and whisker plot of piezometer data and Ca
plot(piezocat$sample_name,piezocat$Ca_mmolL)



#Access BDP subset of piezocat data and make BDP file

BDPpiezocat<-piezocat[which(piezocat$sample_name == "BDP" | piezocat$sample_name == "P1"
                      | piezocat$sample_name == "P2" | piezocat$sample_name == "P3"
                      | piezocat$sample_name == "P4"),]

#Pulls out day of year to plot as x variable (makes scatter plot)
BDPpiezocat$newdate<-mdy(BDPpiezocat$date)
BDPpiezocat$doy<-yday(BDPpiezocat$newdate)

#Plots doy as x and Ca_mmol/L as y
plot(BDPpiezocat$doy,BDPpiezocat$Ca_mmolL)

#Plots BDP Ca data by date and has all depths
library(ggplot2)
pal<-c("#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026")
shape1<-c(21, 22, 23, 24, 25)
BDPCa<-ggplot(BDPpiezocat, aes(newdate,Ca_mmolL,fill=as.factor(Depth_cm),shape=as.factor(Depth_cm)))+
  geom_point(colour="black",size=4)+
  scale_shape_manual(values=shape1)+    
  scale_fill_manual(values=pal)+
  theme_bw(base_size=20)+
  guides(fill=guide_legend(title="Depth (cm)"),shape=guide_legend(title="Depth (cm)"))+
  xlab("\nDate")+
  ylab("Ca (mmol L-1)")
#Call the graph
BDPCa

#save to pdf
pdf("BDPCa.pdf",height=6,width=8)
BDPCa
dev.off()

